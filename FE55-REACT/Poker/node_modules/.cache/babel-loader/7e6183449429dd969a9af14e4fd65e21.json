{"ast":null,"code":"let initialState = {\n  playerList: [{\n    username: \"Player 1\",\n    email: \"player1@gmail.com\",\n    phone: \"1829839030\",\n    totalPoint: 25000,\n    cards: []\n  }, {\n    username: \"Player 2\",\n    email: \"player2@gmail.com\",\n    phone: \"8849839939\",\n    totalPoint: 25000,\n    cards: []\n  }, {\n    username: \"Player 3\",\n    email: \"player3@gmail.com\",\n    phone: \"894589485\",\n    totalPoint: 25000,\n    cards: []\n  }]\n};\n\nconst checkSpecialCase = cards => {\n  const specialCard = [\"KING\", \"JACK\", \"QUEEN\"];\n\n  for (let card of cards) {\n    if (!specialCard.includes(card.value)) {\n      return false;\n    }\n  }\n\n  return true;\n};\n\nconst mapCardToPoint = card => {\n  const specialCard = [\"KING\", \"JACK\", \"QUEEN\"];\n  if (card.value === \"ACE\") return 1;\n  if (specialCard.includes(card.value)) return 10;\n  return +card.value;\n}; // const calcPoint = (winners) => {\n//   for(let player of )\n//   winners.includes(state.playerList);\n// }\n\n\nconst reducer = (state = initialState, {\n  type,\n  payload\n}) => {\n  switch (type) {\n    case \"ADD_PLAYER\":\n      state.playerList = [...state.playerList, payload];\n      return { ...state\n      };\n\n    case \"DRAW_CARD\":\n      const totalPlayer = state.playerList.length;\n      const clonePlayerList = [...state.playerList];\n\n      for (let index in payload) {\n        const playerIndex = index % totalPlayer;\n        clonePlayerList[playerIndex].cards.push(payload[index]);\n      }\n\n      return { ...state,\n        playerList: clonePlayerList\n      };\n\n    /*\r\n        logic tinh diem\r\n        1. check value\r\n        2. tinh diem\r\n          2.1. viết hàm chuyển đổi điểm\r\n          2.2. cộng điểm 3 lá % 10\r\n          2.3. Tìm max\r\n          2.4 Cộng cho max, trừ điểm player còn lại\r\n        */\n\n    case \"REVEAL_CARDS\":\n      {\n        const specialCase = [];\n        const clonePlayerList = [...state.playerList];\n        let totalPoint = 0;\n\n        for (let player of clonePlayerList) {\n          const max = 0;\n          const maxPlayers = [];\n\n          if (checkSpecialCase(player.cards)) {\n            specialCase.push(player);\n          } else {\n            //High order function: reduce, map, find, findIndex\n            totalPoint = player.cards.reduce((total, card) => {\n              return total + mapCardToPoint(card.value);\n            }, 0);\n            return totalPoint = total % 10;\n          }\n\n          if (totalPoint > max) {\n            max = totalPoint;\n            maxPlayers = [player];\n          } else if (totalPoint === max) {\n            maxPlayer.push(player);\n          }\n        }\n\n        const winners = specialCase ? specialCase : maxPlayers;\n        const winPoint = 20000 / winners.length - 5000;\n\n        for (let index in clonePlayerList) {\n          const foundedIndex = winners.find(winner => winner.username === clonePlayerList[index].username);\n\n          if (foundedIndex) {\n            clonePlayerList[index].totalPoint += winPoint;\n          } else {\n            clonePlayerList[index].totalPoint -= 5000;\n          }\n        }\n\n        return { ...state,\n          playerList: clonePlayerList\n        };\n      }\n\n    default:\n      return state;\n  }\n};\n\nexport default reducer; // const totalPlayer = state.playerList.length;\n// const clonePlayerList = [...state.playerList];\n// for (let index in payload) {\n//   const playerIndex = index % totalPlayer;\n//   clonePlayerList[playerIndex].cards.push(payload[index]);\n// };\n// return {...state, playerList : clonePlayerList };","map":{"version":3,"sources":["/Users/mac/Desktop/FE55/FE55-REACT/Poker/src/redux/reducers/player.js"],"names":["initialState","playerList","username","email","phone","totalPoint","cards","checkSpecialCase","specialCard","card","includes","value","mapCardToPoint","reducer","state","type","payload","totalPlayer","length","clonePlayerList","index","playerIndex","push","specialCase","player","max","maxPlayers","reduce","total","maxPlayer","winners","winPoint","foundedIndex","find","winner"],"mappings":"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","sourcesContent":["let initialState = {\r\n  playerList: [\r\n    {\r\n      username: \"Player 1\",\r\n      email: \"player1@gmail.com\",\r\n      phone: \"1829839030\",\r\n      totalPoint: 25000,\r\n      cards: [],\r\n    },\r\n    {\r\n      username: \"Player 2\",\r\n      email: \"player2@gmail.com\",\r\n      phone: \"8849839939\",\r\n      totalPoint: 25000,\r\n      cards: [],\r\n    },\r\n    {\r\n      username: \"Player 3\",\r\n      email: \"player3@gmail.com\",\r\n      phone: \"894589485\",\r\n      totalPoint: 25000,\r\n      cards: [],\r\n    },\r\n  ],\r\n};\r\n\r\nconst checkSpecialCase = (cards) => {\r\n  const specialCard = [\"KING\", \"JACK\", \"QUEEN\"];\r\n  for (let card of cards) {\r\n    if (!specialCard.includes(card.value)) {\r\n      return false;\r\n    }\r\n  }\r\n  return true;\r\n};\r\nconst mapCardToPoint = (card) => {\r\n  const specialCard = [\"KING\", \"JACK\", \"QUEEN\"];\r\n  if (card.value === \"ACE\") return 1;\r\n  if (specialCard.includes(card.value)) return 10;\r\n  return +card.value;\r\n};\r\n\r\n// const calcPoint = (winners) => {\r\n\r\n//   for(let player of )\r\n//   winners.includes(state.playerList);\r\n// }\r\n\r\nconst reducer = (state = initialState, { type, payload }) => {\r\n  switch (type) {\r\n    case \"ADD_PLAYER\":\r\n      state.playerList = [...state.playerList, payload];\r\n      return { ...state };\r\n    case \"DRAW_CARD\":\r\n      const totalPlayer = state.playerList.length;\r\n      const clonePlayerList = [...state.playerList];\r\n      for (let index in payload) {\r\n        const playerIndex = index % totalPlayer;\r\n        clonePlayerList[playerIndex].cards.push(payload[index]);\r\n      }\r\n      return { ...state, playerList: clonePlayerList };\r\n\r\n    /*\r\n        logic tinh diem\r\n        1. check value\r\n        2. tinh diem\r\n          2.1. viết hàm chuyển đổi điểm\r\n          2.2. cộng điểm 3 lá % 10\r\n          2.3. Tìm max\r\n          2.4 Cộng cho max, trừ điểm player còn lại\r\n        */\r\n    case \"REVEAL_CARDS\": {\r\n      const specialCase = [];\r\n     \r\n      const clonePlayerList = [...state.playerList];\r\n      let totalPoint = 0;\r\n      for (let player of clonePlayerList) {\r\n        const max = 0;\r\n        const maxPlayers = [];\r\n        if (checkSpecialCase(player.cards)) {\r\n          specialCase.push(player);\r\n        } else {\r\n          //High order function: reduce, map, find, findIndex\r\n          totalPoint = player.cards.reduce((total, card) => {\r\n           return total + mapCardToPoint(card.value);\r\n          }, 0);\r\n          return totalPoint = total % 10;\r\n        }\r\n        if (totalPoint > max) {\r\n          max = totalPoint;\r\n          maxPlayers = [player];\r\n        } else if (totalPoint === max) {\r\n          maxPlayer.push(player);\r\n        }\r\n      }\r\n     \r\n\r\n      const winners = specialCase ? specialCase : maxPlayers;\r\n      const winPoint = 20000 / winners.length - 5000;\r\n      for (let index in clonePlayerList) {\r\n        const foundedIndex = winners.find(\r\n          (winner) => winner.username === clonePlayerList[index].username\r\n        );\r\n        if (foundedIndex) {\r\n          clonePlayerList[index].totalPoint += winPoint;\r\n        } else {\r\n          clonePlayerList[index].totalPoint -= 5000;\r\n        }\r\n      }\r\n      return {...state, playerList : clonePlayerList};\r\n    }\r\n\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default reducer;\r\n\r\n// const totalPlayer = state.playerList.length;\r\n// const clonePlayerList = [...state.playerList];\r\n// for (let index in payload) {\r\n\r\n//   const playerIndex = index % totalPlayer;\r\n//   clonePlayerList[playerIndex].cards.push(payload[index]);\r\n// };\r\n// return {...state, playerList : clonePlayerList };\r\n"]},"metadata":{},"sourceType":"module"}